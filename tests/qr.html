<html>

<head>
    <title>QR Code Generator</title>
    <meta name="theme-color" content="#df691a">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
    <link href="https://jenil.github.io/bulmaswatch/superhero/bulmaswatch.min.css" rel="stylesheet">
    <script src="https://unpkg.com/bwip-js@2"></script>
</head>

<body>
    <nav class="navbar is-primary">
        <div class="navbar-brand">
            <div class="navbar-item">QR Code Generator</div>
        </div>
    </nav>
    <div class="section has-text-centered">
        <div class="notification" id="drop_zone" ondragover="onDragOver(event)" ondrop="onDrop(event);">
            <div class="subtitle">Drag a link to this Drop Zone</div>
        </div>
        <span id="barcode"></span>
    </div>
</body>
<script>
    var div = document.createElement('div');
    if ('draggable' in div || ('ondragstart' in div && 'ondrop' in div))
        console.log("Drag and Drop API is supported!");

    function onDragOver(ev) {
        ev.preventDefault();
    }

    function onDrop(ev) {
        ev.preventDefault();

        document.getElementById('barcode').innerHTML = ''

        var items = Array.from(ev.dataTransfer.items)
        items.forEach(item => {
            if ((item.kind == 'string') && (item.type.match('^text/plain'))) {
                item.getAsString(drawQRCode);
            }
        })
    }

    function drawQRCode(s) {
        var output = document.getElementById('barcode'),
            canvas = document.createElement('canvas'),
            label = document.createElement('div')

        label.innerHTML = s
        bwipjs.toCanvas(canvas, {
            bcid: 'qrcode',
            text: s,
            scale: 2,
            padding: 10,
            backgroundcolor: 'FFFFFF'
        })

        output.appendChild(canvas)
        output.appendChild(label)
    }
</script>

</html>