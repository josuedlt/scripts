<html>

<head>
    <title>3DS Link to QR Generator</title>
    <meta name="mobile-web-app-capable" content="yes">
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no' />
    <meta name="theme-color" content="#FFCC00">

    <link href="https://jenil.github.io/bulmaswatch/darkly/bulmaswatch.min.css" rel="stylesheet">
    <script src="https://unpkg.com/bwip-js@2"></script>
    <!-- <script src="https://unpkg.com/zepto"></script> -->
</head>

<body class="section has-text-centered">
    <div class="notification is-primary" id="drop_zone" ondragover="onDragOver(event)" ondrop="onDrop(event);">
        <div class="subtitle">Drag a link to this Drop Zone</div>
    </div>
    <div id="barcode"></div>
</body>
<script>
    var div = document.createElement('div');
    if ('draggable' in div || ('ondragstart' in div && 'ondrop' in div))
        console.log("Drag and Drop API is supported!");

    function onDragOver(ev) {
        ev.preventDefault();
    }

    function onDrop(ev) {
        ev.preventDefault();

        var data = ev.dataTransfer.items;
        for (var i = 0; i < data.length; i += 1) {
            if ((data[i].kind == 'string') &&
                (data[i].type.match('^text/plain'))) {
                // This item is the target node
                data[i].getAsString(function (s) {
                    drawQRCode(s)
                });
                // } else if ((data[i].kind == 'string') &&
                //     (data[i].type.match('^text/html'))) {
                //     // Drag data item is HTML
                //     console.log("... Drop: HTML");
                // } else if ((data[i].kind == 'string') &&
                //     (data[i].type.match('^text/uri-list'))) {
                //     // Drag data item is URI
                //     console.log("... Drop: URI");
                // } else if ((data[i].kind == 'file') &&
                //     (data[i].type.match('^image/'))) {
                //     // Drag data item is an image file
                //     var f = data[i].getAsFile();
                //     console.log("... Drop: File ");
                // }
            }
        }
    }

    function drawQRCode(s) {
        console.log(s)

        var output = document.getElementById('barcode'),
            canvas = document.createElement('canvas'),
            label = document.createElement('div')

        label.innerHTML = s
        bwipjs.toCanvas(canvas, {
            bcid: 'qrcode',
            text: s,
            scale: 2,
            padding: 10,
            backgroundcolor: 'FFFFFF'
        })

        output.innerHTML = ''
        output.appendChild(canvas)
        output.appendChild(label)
    }
</script>

</html>